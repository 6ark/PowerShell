<#
https://www.reddit.com/r/PowerShell/comments/quxq3y/how_do_i_exportcsv_with_dynamic_columns_in_each/

IN PROGRESS
#>

$Array1 = @()
$Results = "C:\temp\results.csv"

$Username = for ($i=0; $i -lt 5; $i++){
    "blah$i"
}
$Address = "blahblahblah"

$Username | ForEach-Object {
    $Array1 += New-Object PSObject -Property @{
    "Username" = $_;
    "Address" = $Address
    }
}

$Array1 | ForEach-Object {
    $Array1 += New-Object PSObject -Property @{
        "Authphone_$j" = $Authphonevalue
    }
}

$Array1 | Select-Object "Username", "Address" -ExcludeProperty PSComputerName, RunspaceId, PSShowComputerName | Export-Csv -Path $Results -NoTypeInformation -Force

#View the contents of array
$Array1

# Open results file as csv
Start-Process -FilePath $Results
